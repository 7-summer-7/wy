[2026-02-02 17:56:23] Stage 0: load data...
[2026-02-02 17:56:23] Stage 0: done. Exports + preprocessors saved.
[2026-02-02 17:56:28] Stage 1: tuning DT ...
[2026-02-02 17:56:44] Stage 1: DT done. CV AUC=0.6839 runtime=4.3s
[2026-02-02 17:56:44] Stage 1: tuning RF ...
[2026-02-02 17:57:03] Stage 1: RF done. CV AUC=0.7635 runtime=7.3s
[2026-02-02 17:57:03] Stage 1: tuning XGB ...
[2026-02-02 17:57:18] Stage 1: XGB done. CV AUC=0.7714 runtime=3.5s
[2026-02-02 17:57:18] Stage 1: tuning SVM ...
[2026-02-02 17:57:42] Stage 1: SVM done. CV AUC=0.7734 runtime=12.5s
[2026-02-02 17:57:42] Stage 1: tuning GBDT ...
[2026-02-02 17:58:01] Stage 1: GBDT done. CV AUC=0.7751 runtime=6.6s
[2026-02-02 17:58:01] Stage 1: plotting TEST ROC/Calibration/DCA panels (with CI)...
[2026-02-02 17:59:54] Stage 1: done.
[2026-02-02 17:59:54] Stage 2: Stage1 best model by TEST AUC median = SVM
[2026-02-02 17:59:54] Stage 2: computing SHAP once...
[2026-02-02 18:00:53] Stage 2: SHAP-RFE loop start (fixed ranking, refit each step, record TEST AUC point)...
[2026-02-02 18:00:56] Stage 2: best features = 10 | best TEST AUC=0.7973
[2026-02-02 18:00:56] Stage 2: done.
[2026-02-02 18:01:34] Stage 3: retrain DT with best features (no tuning)...
[2026-02-02 18:01:47] Stage 3: retrain RF with best features (no tuning)...
[2026-02-02 18:02:10] Stage 3: retrain XGB with best features (no tuning)...
[2026-02-02 18:02:29] Stage 3: retrain SVM with best features (no tuning)...
[2026-02-02 18:02:41] Stage 3: retrain GBDT with best features (no tuning)...
[2026-02-02 18:02:54] Stage 3: done.
[2026-02-02 18:03:15] Stage 4: done.
[2026-02-02 18:05:37] Stage 5: plotting comparison panels (ROC/Calib/DCA) for TEST & EXT...
[2026-02-02 18:12:12] Stage 5: SHAP for base learners (cache + beeswarm + bar)...
[2026-02-02 18:12:12]   DT: computing SHAP ...
[2026-02-02 18:12:12]   RF: computing SHAP ...
[2026-02-02 18:12:13]   XGB: computing SHAP ...
[2026-02-02 18:12:14]   SVM: computing SHAP ...
[2026-02-02 18:13:29]   GBDT: computing SHAP ...
[2026-02-02 18:13:31] Stage 5: SHAP for meta-learner (cached) + force/waterfall...
[2026-02-02 18:13:33] Stage 5: GLOBAL stacking SHAP (KernelExplainer) explain=500 background=100 (cached)...
[2026-02-03 16:10:15] Stage 6: precomputing mixed distance matrix for silhouette on Cohort1 (n=1500) ...
[2026-02-03 16:10:15] Stage 6: scanning K with cost + silhouette on Cohort1...
[2026-02-03 16:10:15]   K=2 cost=9364.13 silhouette=0.391
[2026-02-03 16:10:15]   K=3 cost=8223.91 silhouette=0.393
[2026-02-03 16:10:15]   K=4 cost=7290.07 silhouette=0.272
[2026-02-03 16:10:15]   K=5 cost=6439.45 silhouette=0.284
[2026-02-03 16:10:15]   K=6 cost=5838.77 silhouette=0.289
[2026-02-03 16:10:15]   K=7 cost=5581.75 silhouette=0.222
[2026-02-03 16:10:16]   K=8 cost=5449.00 silhouette=0.214
[2026-02-03 16:10:18] Stage 6: final K-prototypes on Cohort1 with K=3 ...
[2026-02-03 16:10:24] Stage 6: done.
[2026-02-03 16:12:02] Loaded model: results_article_style\models\stage1_all_features\XGB.joblib
[2026-02-03 16:12:03] Plotted SHAP dependence (scatter only) for SALT -> results_article_style\figures\stage3_xgb_shap_dependence_SALT.svg
[2026-02-03 16:12:04] Plotted SHAP dependence (scatter only) for 25(OH)D3 -> results_article_style\figures\stage3_xgb_shap_dependence_25(OH)D3.svg
[2026-02-03 16:12:04] Plotted SHAP dependence (scatter only) for Age -> results_article_style\figures\stage3_xgb_shap_dependence_Age.svg
[2026-02-03 16:12:05] Plotted SHAP dependence (scatter only) for tIgE -> results_article_style\figures\stage3_xgb_shap_dependence_tIgE.svg
[2026-02-03 16:12:06] Plotted SHAP dependence (scatter only) for Duration -> results_article_style\figures\stage3_xgb_shap_dependence_Duration.svg
[2026-02-03 16:12:06] Stage3 (scatter-only SHAP dependence): done.
[2026-02-03 16:13:41] Binary-core retrain: fitting DT ...
[2026-02-03 16:13:41] Binary-core retrain: fitting RF ...
[2026-02-03 16:13:41] Binary-core retrain: fitting XGB ...
[2026-02-03 16:13:41] Binary-core retrain: fitting SVM ...
[2026-02-03 16:13:41] Binary-core retrain: fitting GBDT ...
[2026-02-03 16:13:41] Binary-core retrain: fitting STACK (LR meta, 5-fold CV stacking) ...
[2026-02-03 16:13:47] Binary-core retrain: generating SVM single-sample SHAP force/waterfall (SVG) ...
[2026-02-03 16:13:48]   Saved: results_article_style\figures\svm_binary_core_force_example.svg
[2026-02-03 16:13:48]   Saved: results_article_style\figures\svm_binary_core_waterfall_example.svg
[2026-02-03 16:13:48] Binary-core retrain: done.
[2026-02-03 16:14:47] Starting web calculator on http://127.0.0.1:5000
[2026-02-03 19:09:15] Binary-core retrain: fitting DT ...
[2026-02-03 19:09:15] Binary-core retrain: fitting RF ...
[2026-02-03 19:09:16] Binary-core retrain: fitting XGB ...
[2026-02-03 19:09:16] Binary-core retrain: fitting SVM ...
[2026-02-03 19:09:16] Binary-core retrain: fitting GBDT ...
[2026-02-03 19:09:16] Binary-core retrain: fitting STACK (LR meta, 5-fold CV stacking) ...
[2026-02-03 19:09:18] Binary-core retrain: building TEST metrics comparison table (bootstrap 95% CI) ...
[2026-02-03 19:09:30] Binary-core retrain: building EXT metrics comparison table (bootstrap 95% CI) ...
[2026-02-03 19:09:43] Binary-core retrain: done.
[2026-02-03 19:14:34] Starting web calculator on http://127.0.0.1:5000
[2026-02-03 20:10:44] Starting web calculator on http://127.0.0.1:5000
[2026-02-03 20:14:43] Starting web calculator on http://127.0.0.1:5000
[2026-02-03 20:18:15] Starting web calculator on http://127.0.0.1:5000
[2026-02-03 20:29:32] Starting web calculator on http://127.0.0.1:5000
[2026-02-03 20:44:32] Starting web calculator on http://127.0.0.1:5000
